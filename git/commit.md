# 项目修改和提交

&emsp;&emsp;当从远程仓库克隆一个 Git 项目到本地，成为本地仓库，或者自建一个空的本地仓库后，大部分情况下需要修改其中的文档，然后提交你的修改到仓库形成一个版本。请注意，**修改文档不会产生新的版本，提交后才会产生新的版本**。

***

##### 项目的修改

&emsp;&emsp;一个项目可能包含很多类型的文档，如文本文档、图片、音乐、视频、加密文件等等，只要操作系统能识别，都可以出现在项目中。

&emsp;&emsp;对项目的修改，实际就是对这些文档的修改，你可以使用最合适的文档编辑工具对这些文档增删改。

&emsp;&emsp;**再次强调：对文档的修改产生新的版本！**

##### 项目的提交

&emsp;&emsp;项目在完成了一个阶段的目标之后，需要提交更新到仓库。

&emsp;&emsp;请记住，你工作目录下的每一个文件都不外乎这两种状态：已跟踪或未跟踪。已跟踪的文件是指那些被纳入了版本控制的文件，在上一次快照中有它们的记录，在工作一段时间后，它们的状态可能处于未修改，已修改或已放入暂存区。 工作目录中除已跟踪文件以外的所有其它文件都属于未跟踪文件，它们既不存在于上次快照的记录中，也没有放入暂存区。 初次克隆某个仓库的时候，工作目录中的所有文件都属于已跟踪文件，并处于未修改状态。

&emsp;&emsp;编辑过某些文件之后，由于自上次提交后你对它们做了修改，Git 将它们标记为已修改文件。 我们逐步将这些修改过的文件放入暂存区，然后提交所有暂存了的修改，如此反复。 

##### 检查当前文件状态

&emsp;&emsp;要查看哪些文件处于什么状态，可以用 ```git status``` 命令。


#####  跟踪新文件

&emsp;&emsp;使用命令 ```git add``` 开始跟踪一个文件。


##### 暂存已修改文件

&emsp;&emsp;要暂存已修改文件，需要运行 git add 命令。 这是个多功能命令：可以用它开始跟踪新文件，或者把已跟踪的文件放到暂存区，还能用于合并时把有冲突的文件标记为已解决状态等。


##### 状态简览
&emsp;&emsp;```git status``` 命令的输出十分详细，但其用语有些繁琐。 如果你使用 ```git status -s``` 命令或 ```git status --short``` 命令，你将得到一种更为紧凑的格式输出。


##### 忽略文件

&emsp;&emsp;一般我们总会有些文件无需纳入 Git 的管理，也不希望它们总出现在未跟踪文件列表。 通常都是些自动生成的文件，比如日志文件，或者编译过程中创建的临时文件等。 在这种情况下，我们可以创建一个名为 .gitignore 的文件，列出要忽略的文件模式。 

&emsp;&emsp;文件 .gitignore 的格式规范如下：

&emsp;&emsp;所有空行或者以 ＃ 开头的行都会被 Git 忽略。

&emsp;&emsp;可以使用标准的 glob 模式匹配。

&emsp;&emsp;匹配模式可以以（/）开头防止递归。

&emsp;&emsp;匹配模式可以以（/）结尾指定目录。

&emsp;&emsp;要忽略指定模式以外的文件或目录，可以在模式前加上惊叹号（!）取反。

&emsp;&emsp;所谓的 glob 模式是指 shell 所使用的简化了的正则表达式。 星号（\*）匹配零个或多个任意字符；\[abc\] 匹配任何一个列在方括号中的字符（这个例子要么匹配一个 a，要么匹配一个 b，要么匹配一个 c）；问号（\?）只匹配一个任意字符；如果在方括号中使用短划线分隔两个字符，表示所有在这两个字符范围内的都可以匹配（比如 \[0-9\] 表示匹配所有 0 到 9 的数字）。 使用两个星号（\*) 表示匹配任意中间目录，比如a/\*\*/z 可以匹配 a/z, a/b/z 或 a/b/c/z等。

&emsp;&emsp;GitHub 有一个十分详细的针对数十种项目及语言的 .gitignore 文件列表，可以在https://github.com/github/gitignore 找到它。

##### 查看已暂存和未暂存的修改

&emsp;&emsp;```git status``` 命令的输出可能过于模糊，要知道具体修改了什么地方，可以用 ```git diff``` 命令。通常会用它来回答这两个问题：当前做的哪些更新还没有暂存？ 有哪些更新已经暂存起来准备好了下次提交？ 尽管 ```git status``` 已经通过在相应栏下列出文件名的方式回答了这个问题，```git diff``` 将通过文件补丁的格式显示具体哪些行发生了改变。

&emsp;&emsp;请注意，```git diff``` 本身只显示尚未暂存的改动，而不是自上次提交以来所做的所有改动。 所以有时候你一下子暂存了所有更新过的文件后，运行 ```git diff``` 后却什么也没有，就是这个原因。

##### 提交更新
&emsp;&emsp;现在的暂存区域已经准备妥当可以提交了。 在此之前，请一定要确认还有什么修改过的或新建的文件还没有 ```git add``` 过，否则提交的时候不会记录这些还没暂存起来的变化。 这些修改过的文件只保留在本地磁盘。 所以，每次准备提交前，先用 ```git status``` 看下，是不是都已暂存起来了， 然后再运行提交命令:
```
git commit
```
这种方式会启动文本编辑器以便输入本次提交的说明。

另外，你也可以在 commit 命令后添加 -m 选项，将提交信息与命令放在同一行。

提交的说明应尽量详细些，这样不仅方便项目伙伴阅读，也便于长时间过后自己还能明白项目有哪些更改。

请记住，提交时记录的是放在暂存区域的快照。 任何还未暂存的仍然保持已修改状态，可以在下次提交时纳入版本管理。 每一次运行提交操作，都是对你项目作一次快照，以后可以回到这个状态，或者进行比较。

##### 跳过使用暂存区域

&emsp;&emsp;尽管使用暂存区域的方式可以精心准备要提交的细节，但有时候这么做略显繁琐。 Git 提供了一个跳过使用暂存区域的方式， 只要在提交的时候，给 ```git commit``` 加上 -a 选项，Git 就会自动把所有已经跟踪过的文件暂存起来一并提交，从而跳过 ```git add```步骤。

##### 移除文件

要从 Git 中移除某个文件，就必须要从已跟踪文件清单中移除（确切地说，是从暂存区域移除），然后提交。 可以用 git rm 命令完成此项工作，并连带从工作目录中删除指定的文件，这样以后就不会出现在未跟踪文件清单中了。

如果只是简单地从工作目录中手工删除文件，运行 git status 时就会在 “Changes not staged for commit” 部分（也就是 未暂存清单）看到。

##### 移动文件

不像其它的 VCS 系统，Git 并不显式跟踪文件移动操作。 如果在 Git 中重命名了某个文件，仓库中存储的元数据并不会体现出这是一次改名操作。

要在 Git 中对文件改名，可以使用命令
```
git mv file_from file_to
```

***

上面讲到的都是 Git 项目修改和提交的原理和相关命令。如果使用 GUI 工具，上述操作就相对简单多了。

1. 修改项目文件。对项目文件进行增删改。

2. 在项目根目录打开右键菜单，点击【 Git Commit -> "master"】提交项目。
![项目提交1](/image/Commit.jpg)

3. 在弹出的框中上面的【Message】填写提交的说明。下面选择要提交的文件列表。一般选择【All】
![项目提交2](/image/Commit2.jpg)



